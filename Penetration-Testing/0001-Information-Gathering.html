<!DOCTYPE html>
<html lang="en"><head><title>Information Gathering</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Bricolage Grotesque:wght@400;700&amp;family=Bricolage Grotesque:ital,wght@0,400;0,600;1,400;1,600&amp;family=Jebtrains Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Husenjan"/><meta property="og:title" content="Information Gathering"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Information Gathering"/><meta name="twitter:description" content="OSINT OSINT (Open Source Intelligence) is about gathering information about our target using public resources available for us in the internet."/><meta property="og:description" content="OSINT OSINT (Open Source Intelligence) is about gathering information about our target using public resources available for us in the internet."/><meta property="og:image:alt" content="OSINT OSINT (Open Source Intelligence) is about gathering information about our target using public resources available for us in the internet."/><meta property="twitter:domain" content="husenjan.com"/><meta property="og:url" content="https://husenjan.com/Penetration-Testing/0001-Information-Gathering"/><meta property="twitter:url" content="https://husenjan.com/Penetration-Testing/0001-Information-Gathering"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="OSINT OSINT (Open Source Intelligence) is about gathering information about our target using public resources available for us in the internet."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxoaGVzZW5qYW5cXERvY3VtZW50c1xcUXVhcnR6XFxRdWFydHoyXFxxdWFydHpcXHF1YXJ0elxcY29tcG9uZW50c1xcc3R5bGVzIiwic291cmNlcyI6WyJtZXJtYWlkLmlubGluZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFHRjtFQUNFOzs7QUFLRjtFQUNFO0VBQ0E7OztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUlKO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFOztBQUlGO0VBQ0U7RUFDQTtFQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLmV4cGFuZC1idXR0b24ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsb2F0OiByaWdodDtcbiAgcGFkZGluZzogMC40cmVtO1xuICBtYXJnaW46IDAuM3JlbTtcbiAgcmlnaHQ6IDA7IC8vIE5PVEU6IHJpZ2h0IHdpbGwgYmUgc2V0IGluIG1lcm1haWQuaW5saW5lLnRzXG4gIGNvbG9yOiB2YXIoLS1ncmF5KTtcbiAgYm9yZGVyLWNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICBib3JkZXI6IDFweCBzb2xpZDtcbiAgYm9yZGVyLXJhZGl1czogNXB4O1xuICBvcGFjaXR5OiAwO1xuICB0cmFuc2l0aW9uOiAwLjJzO1xuXG4gICYgPiBzdmcge1xuICAgIGZpbGw6IHZhcigtLWxpZ2h0KTtcbiAgICBmaWx0ZXI6IGNvbnRyYXN0KDAuMyk7XG4gIH1cblxuICAmOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgYm9yZGVyLWNvbG9yOiB2YXIoLS1zZWNvbmRhcnkpO1xuICB9XG5cbiAgJjpmb2N1cyB7XG4gICAgb3V0bGluZTogMDtcbiAgfVxufVxuXG5wcmUge1xuICAmOmhvdmVyID4gLmV4cGFuZC1idXR0b24ge1xuICAgIG9wYWNpdHk6IDE7XG4gICAgdHJhbnNpdGlvbjogMC4ycztcbiAgfVxufVxuXG4jbWVybWFpZC1jb250YWluZXIge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIGNvbnRhaW46IGxheW91dDtcbiAgei1pbmRleDogOTk5O1xuICBsZWZ0OiAwO1xuICB0b3A6IDA7XG4gIHdpZHRoOiAxMDB2dztcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgb3ZlcmZsb3c6IGhpZGRlbjtcbiAgZGlzcGxheTogbm9uZTtcbiAgYmFja2Ryb3AtZmlsdGVyOiBibHVyKDRweCk7XG4gIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTtcblxuICAmLmFjdGl2ZSB7XG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICB9XG5cbiAgJiA+ICNtZXJtYWlkLXNwYWNlIHtcbiAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgICBib3JkZXItcmFkaXVzOiA1cHg7XG4gICAgcG9zaXRpb246IGZpeGVkO1xuICAgIHRvcDogNTAlO1xuICAgIGxlZnQ6IDUwJTtcbiAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTtcbiAgICBoZWlnaHQ6IDgwdmg7XG4gICAgd2lkdGg6IDgwdnc7XG4gICAgb3ZlcmZsb3c6IGhpZGRlbjtcblxuICAgICYgPiAubWVybWFpZC1jb250ZW50IHtcbiAgICAgIHBhZGRpbmc6IDJyZW07XG4gICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICB0cmFuc2Zvcm0tb3JpZ2luOiAwIDA7XG4gICAgICB0cmFuc2l0aW9uOiB0cmFuc2Zvcm0gMC4xcyBlYXNlO1xuICAgICAgb3ZlcmZsb3c6IHZpc2libGU7XG4gICAgICBtaW4taGVpZ2h0OiAyMDBweDtcbiAgICAgIG1pbi13aWR0aDogMjAwcHg7XG5cbiAgICAgIHByZSB7XG4gICAgICAgIG1hcmdpbjogMDtcbiAgICAgICAgYm9yZGVyOiBub25lO1xuICAgICAgfVxuXG4gICAgICBzdmcge1xuICAgICAgICBtYXgtd2lkdGg6IG5vbmU7XG4gICAgICAgIGhlaWdodDogYXV0bztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmID4gLm1lcm1haWQtY29udHJvbHMge1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgYm90dG9tOiAyMHB4O1xuICAgICAgcmlnaHQ6IDIwcHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZ2FwOiA4cHg7XG4gICAgICBwYWRkaW5nOiA4cHg7XG4gICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgYm9yZGVyLXJhZGl1czogNnB4O1xuICAgICAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcbiAgICAgIHotaW5kZXg6IDI7XG5cbiAgICAgIC5tZXJtYWlkLWNvbnRyb2wtYnV0dG9uIHtcbiAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIHdpZHRoOiAzMnB4O1xuICAgICAgICBoZWlnaHQ6IDMycHg7XG4gICAgICAgIHBhZGRpbmc6IDA7XG4gICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgICAgY29sb3I6IHZhcigtLWRhcmspO1xuICAgICAgICBib3JkZXItcmFkaXVzOiA0cHg7XG4gICAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgICAgZm9udC1zaXplOiAxNnB4O1xuICAgICAgICBmb250LWZhbWlseTogdmFyKC0tYm9keUZvbnQpO1xuICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4ycyBlYXNlO1xuXG4gICAgICAgICY6aG92ZXIge1xuICAgICAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICAgIH1cblxuICAgICAgICAmOmFjdGl2ZSB7XG4gICAgICAgICAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKDFweCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdHlsZSB0aGUgcmVzZXQgYnV0dG9uIGRpZmZlcmVudGx5XG4gICAgICAgICY6bnRoLWNoaWxkKDIpIHtcbiAgICAgICAgICB3aWR0aDogYXV0bztcbiAgICAgICAgICBwYWRkaW5nOiAwIDEycHg7XG4gICAgICAgICAgZm9udC1zaXplOiAxNHB4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0= */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://husenjan.com/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://husenjan.com/Penetration-Testing/0001-Information-Gathering-og-image.webp"/><meta property="og:image:url" content="https://husenjan.com/Penetration-Testing/0001-Information-Gathering-og-image.webp"/><meta name="twitter:image" content="https://husenjan.com/Penetration-Testing/0001-Information-Gathering-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="Penetration-Testing/0001-Information-Gathering"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="..">Husenjan</a></h2><div class="spacer mobile-only"></div><div style="display: flex; flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" class="readerIcon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="12" height="16" rx="1"></rect><line x1="9" y1="8" x2="15" y2="8"></line><line x1="9" y1="12" x2="15" y2="12"></line><line x1="9" y1="16" x2="13" y2="16"></line></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-content"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="explorer-content" aria-expanded="false"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div><div class="recent-notes"><h3>Recent Writings</h3><ul class="recent-ul"><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Penetration-Testing/0000-Introduction" class="internal">Introduction to Penetration Testing</a></h3></div><p class="meta"><time datetime="2025-04-20T00:00:00.000Z">Apr 20, 2025</time></p></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Penetration-Testing/0001-Information-Gathering" class="internal">Information Gathering</a></h3></div><p class="meta"><time datetime="2025-04-15T00:00:00.000Z">Apr 15, 2025</time></p></div></li><li class="recent-li"><div class="section"><div class="desc"><h3><a href="../Documents/0010-Abusing-Active-Directory-Certificate-Services" class="internal">Exploiting Active Directory Certificate Service</a></h3></div><p class="meta"><time datetime="2024-12-31T00:00:00.000Z">Dec 31, 2024</time></p></div></li></ul></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../Penetration-Testing/">Penetration Testing</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Information Gathering</a></div></nav><h1 class="article-title">Information Gathering</h1><p show-comma="true" class="content-meta"><time datetime="2025-04-15T00:00:00.000Z">Apr 15, 2025</time><span>26 min read</span></p><ul class="tags"><li><a href="../tags/Penetration-Testing" class="internal tag-link">Penetration-Testing</a></li></ul></div></div><article class="popover-hint"><h2 id="osint">OSINT<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#osint" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>OSINT (Open Source Intelligence) is about gathering information about our target using public resources available for us in the internet. It’s a-lot of information’s that is possible to obtain through internet because employees are simply not aware of best security practices.</p>
<h3 id="employees">Employees<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#employees" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Simplest and easiest way to obtain information’s about a organization is by inspecting job requirements and employees social media accounts as these will contain information’s about laptops, technologies, and operating system the organization uses. Here are some real scenarios where employees might be sharing confidential information’s without being aware of it.</p>
<p><strong>What laptops, computers, and operating systems does the organization use?</strong> This information is critical for threat actors as that allows them to prepare their payloads for the specific laptop, computer, and operating system. An employee can easily and quickly leak these information’s by posting a picture of their workspace on social media or by posting a comment about a issue which they are experiencing with their laptops.</p>
<p><strong>What are the user principal name of employees in a organization?</strong> This information is also critical for threat actors as it allows them to do password brute-force attack on users after accessing our network. This information is easily collectable through LinkedIn as most companies uses the first character of first name and the full last name as their user principal name. An example of that is Joe Doe user principal is JDoe.</p>
<p><strong>What technologies does the organization use?</strong> This information is also critical for threat actors as allows them to research our technologies to potentially find a weakness. This information can easily be obtained through LinkedIn job specifications or by an employee asking for advice in <a href="https://stackoverflow.com" class="external">StackOverflow<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
<p>A employee could also be getting bribed or blackmailed by the threat actor to leak these information’s. A important thing to note is a threat actor can be a employee, competitor, or malicious threat actor that wants to compromise your organization for financial gain.</p>
<h3 id="domain-name">Domain Name<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#domain-name" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Domain Name contains a-lot of valuable information’s such as owner of domain, subdomains, and text records which can be used to obtain the technologies the organization uses. Here are some tools which can assist us with obtaining all these information’s.</p>
<p><a href="https://crt.sh/" class="external">CRT.SH<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> is a tool that allows us to obtain information’s about the subdomains and the IP-addresses that belongs to the subdomain. It’s possible for us to use the CURL with the CRT.SH web application to obtain these information’s.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Curling CRT.SH</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Curling information about a website</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'https://crt.sh/?q=husenjan.com&amp;output=json'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> jq</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ':'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'CN='</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&quot;'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '{gsub(/\\n/,&quot;\n&quot;);}1;'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subdomainlist</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Getting the IP-addresses for these hosts</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subdomainlist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> host $i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'has address'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'husenjan.com'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f1,4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span></code></pre></figure>
<p><a href="https://search.censys.io/" class="external">Censys<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> is a great alternative to <a href="https://crt.sh/" class="external">CRT.SH<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> it also allows us to obtain informations about the subdomains and IP-addresses that belongs to the subdomain.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Domain Name</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://search.censys.io/search?resource=hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">RELEVANCE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;per_page</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;virtual_hosts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EXCLUDE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp;q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">husenjan.com</span></span></code></pre></figure>
<p><a href="https://www.shodan.io/" class="external">Shodan.io<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> is the perfect tool to use after obtaining the IP-addresses of our targets as it allows us to see which ports are open on our targets and potential links between the IP-address and another IP-address.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Obaiting Information with Shodan</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Capturing only IP-addresses </span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subdomainlist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'has address'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'husenjan.com'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ' '</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> iplist</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Using Shodan on these IP-addresses</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> iplist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> shodan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $i; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span></code></pre></figure>
<p>Dig is a good command to be familiar with as it allows us to fetch domain name records such as IP-addresses and text records.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Obtaining Information with Dig</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'husenjan.com'</span></span></code></pre></figure>
<p>The text records can contain information’s about the technologies the organization uses such as Outlook, Gmail, LogMeIn and so forth. Which are valuable information as it allows us to create phishing email which bypasses these technologies.</p>
<h3 id="cloud-storage">Cloud Storage<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cloud-storage" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Cloud Storages are widely used in all organization’s in some kind of form and these cloud storages can easily be misconfigured by a employee and that will allow the threat actor to access it without any authentication. It’s fairly easy to find these cloud storages using Google Search engine.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Amazon S3 Bucket &amp; Azure Blobs &amp; Google Cloud Storage</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Amazon S3 Bucket</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">intext:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'&lt;COMPANY-NAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inurl:'amazonaws.com'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Azure Blobs</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">intext:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'&lt;COMPANY-NAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inurl:'blob.core.windows.net'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Google Cloud Storage</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">intext:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'&lt;COMPANY-NAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inurl:'storage.googleapis.com'</span></span></code></pre></figure>
<p>Inside cloud storage there can be confidential documents, ssh keys, and passwords which are extremely valuable. It’s impossible for a organization to track all these activities because the traffic could be from a visitor or employee. If you’re interested in learning more about OSINT, I highly recommend checking out the <a href="https://osintframework.com/" class="external">OSINT Framework<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
<h2 id="nmap">Nmap<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nmap" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Network Mapper (Nmap) is a critical tool for penetration testing as it allows us to obtain information’s about our targets. It comes with capabilities such as Host Discovery, Port scanning, and Operating System Detection and so forth…</p>
<p>It’s always recommended to do manual enumeration after obtaining information’s from Nmap as there might be security misconfiguration or vulnerabilities which were not detected by Nmap. It’s also a good practice to always do manual enumeration as that will allow us to understand the service and the purpose of it which could save us anywhere from hours to days.</p>
<p><strong>What is Host Discovery?</strong> It’s a technique in Nmap that enables us to search through a IP-address range or an list to find active hosts. This is great for situations were we need to search for active hosts in an environment to find potential targets.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Host Discovery</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scans through range of IP-addresses</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.129.2.0/24</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -oA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tnet</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot; &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scans through a list of IP-addresses</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -oA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tnet</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -iL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOST-LIST>'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f5</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scans through multiple of IP-addresses</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -oA</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.129.2.0-20</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot; &quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f5</span></span></code></pre></figure>
<p><strong>What is Port Scanning?</strong> It’s a technique in Nmap that enables us to search for open TCP and UDP ports on our targets and obtain information’s about the services running on these ports. The main difference between TCP and UDP ports is the TCP port uses three way handshake and ensures that all packet sent from client and server is received while UDP keeps sending packets while delivery of packets fails.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Port Scanning</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scanning for TCP ports</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --min-rate=10000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --disable-arp-ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --packet-trace</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scanning for TCP ports Half Handshake</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --min-rate=10000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --disable-arp-ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --packet-trace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scanning for UDP ports</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sU</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --min-rate=10000</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --disable-arp-ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --packet-trace</span></span></code></pre></figure>
<p>When Nmap is completed with scanning our targets the ports can be in different states such as open, closed, filtered, and unfiltered because the firewall, intrusion detection system, or intrusion prevention system disallowed our packets from accessing or communicating with these ports. It’s possible to bypass these protection by using the following commands.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Bypassing Firewalls &amp; IDS &amp; IPS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap 1.0: For testing Firewall/IDS/IPS...</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Pn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --disable-arp-ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap 1.1: Bypassing security protection by using decoy IP-addresses</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Pn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --disable-arp-ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --packet-trace</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -D</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RND:5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap 1.2 : Bypassing security protection by using spoofed IP-address</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Pn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;SPOOFED-IP>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tun0</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap 1.3: Bypassing security protection by using DNS Proxying</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Pn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sS</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 445</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --disable-arp-pint</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --packet-trace</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --source-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 53</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Interacting with Port using DNS Proxy</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ncat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --source-port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 53</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RPORT>'</span></span></code></pre></figure>
<p>If our port connection comes back as <code>Filtered</code> it means that our packets were blocked by the firewall, intrusion detection system, or intrusion prevention system. We can try the different commands to bypass the security mechanisms and after successfully bypassing it we can use <code>ncat</code> to manually enumerate the service.</p>
<h2 id="protocols">Protocols<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#protocols" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Understanding the functionality of different protocols such as SSH, FTP, SMB, NFS, DNS, SMTP, IMAP &amp; POP3, SNMP, MySQL, MMSQL, Oracle TNS, and IPMI is important because these are services that will be found in a-lot organization’s and sometimes these services can be misconfigured which allows us to obtain information’s about the organization’s infrastructure.</p>
<h3 id="ssh">SSH<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ssh" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Secure Shell (SSH) is a network protocol that enables us to securely and remotely communicate with our servers and machines through a encrypted tunnel. It’s possible to configure SSH to accept passwords or a RSA key. Here’s a overview of logging into a server using SSH.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SSH</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging in using password</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">USERNAM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging in using RSA key</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id_rsa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">USERNAM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span></code></pre></figure>
<p>The preferred authentication method in 2025 is RSA key as password is something which can be guessed by a threat actor. However, passwords are still widely used for SSH nowadays.</p>
<h3 id="ftp">FTP<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ftp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>File Transfer Protocol (FTP) is one of the oldest protocols that runs at the application layer. The FTP protocol was first establishes a connection on TCP Port 21 which is used for sending commands and returning error codes. The FTP service then establishes another connection at TCP Port 20 which is used for transferring from user to server and server to user. Here are overview of some commands that can come in good use while working with FTP service.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">FTP</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Conencting as anonymous </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ftp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> anonymous@10.129.15.20</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FTP: Download file</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;FILE>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FTP: Upload file</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;FILE>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># FTP: Downloading all files</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --no-passive</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'ftp://&lt;USERNAME>@&lt;IP>'</span></span></code></pre></figure>
<p>In some instances the FTP service can be misconfigured to allow anonymous logins which allows everyone to access the FTP service without authenticating and in these situations the FTP service is a goldmine as threat actors can download confidential files and replace executables with their malicious executable.</p>
<h3 id="smb">SMB<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#smb" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Server Message Block (SMB) is a client-server protocol that regulates access to files, directories, and other networks such as printer, routers, and interfaces released for the network. An alternative for SMB is Samba which is developed for Unix-based operating systems and it allows Linux systems to communicate with Windows severs. In modern infrastructure the SMB and Samba uses the TCP Port 445 while in legacy infrastructure the UDP Port 137, 138, and 139 are commonly used. Here are some commands which I recommend familiarizing yourself with as SMB service is common in almost all environment’s nowadays.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SMB</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Listing all directories inside SMB client</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">smbclient</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '\\\\&lt;RHOST>\\'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMB: Download a file</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;FILE>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMB: Upload a file</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">put</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;FILE>'</span></span></code></pre></figure>
<p>In some environments the SMB service allows the guest user to access shares and this can lead to unauthorized access to confidential files and replace files with their malicious executables.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SMB</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging in as guest to SMB service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">smbclient</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'guest'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\\\</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">SHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging in as guest to SMB service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">crackmapexec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> smb</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --shares</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'guest'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ''</span></span></code></pre></figure>
<p>After successfully accessing the SMB service it’s possible to obtain information’s about the Windows server using Enum4Linux and RPCClient but that requires us to manually enumerate the SMB service.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SMB</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">enum4linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">RPCClient</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Logging in as anonymous user with RPCClient</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rpcclient</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting server information's</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">srvinfo</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting domain information's</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">enundomains</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting more domain information's</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">querydominfo</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting file share information's</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netshareenumall</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># PRCClient: Getting information about a directory</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netsharegetinfo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;DIRECTORY>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting all users from SMB service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">enumdomusers</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># RPCClient: Getting user information's from SMB service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">queryuser</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HEX-ID>'</span></span></code></pre></figure>
<p>One thing that should be “must do” is running enum4linux against the SMB service at all penetration tests as it can help us obtain a-lot of information’s about the Windows server. I highly recommend setting up a SMB service and try to understand the service as well as possible as it’s almost used in all environments.</p>
<h3 id="nfs">NFS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nfs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Network File System (NFS) is a protocol developed for the same purpose as SMB. NFS is mostly optimized for Linux and Unix operating systems and it comes with different version such as NFS v2, NFSv3, and NFS v4 and each of them comes with different capabilities.</p>
<p>The NFS v2 is supported by many systems and operates over the UDP protocol. The NFS v3 comes with capabilities to handle larger files, better synchronization, and better error reporting. The NFS v4 includes Kerberos, ACL support, performance improvements, and higher security. It’s extremely simple to setup NFS share in our Linux environment.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">NFS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Replace '10.129.10.0' with your IP subnet</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '/mnt/nfs  10.129.10.0/24(sync,no_subtree_check)'</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> >></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/exports</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Restart the NFS service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nfs-kernel-server</span></span></code></pre></figure>
<p>Once the NFS server is up and running it’s possible to use the following commands to mount and un-mount the NFS share from our client devices.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">NFS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Lists all mounts for NFS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">showmount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Mounts the NFS to a directory</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>:/'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;LOCAL-FOLDER>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nolock</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># List all files to mounted directory</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lna</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'LOCATION'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Unmounts the NFS share</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> umount</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;LOCAL-FOLDER>'</span></span></code></pre></figure>
<p>When NFS has <code>no_root_squash</code> inside <code>/etc/exports</code> it will allow threat actors to elevate their privileges using SUID which is uploading the file as root and executing it on the server as a normal user.</p>
<h3 id="dns">DNS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dns" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Domain Name System (DNS) is a protocol for resolving domain names to IP addresses as that allows organizations to setup domains such as marketing.int.husenjan.com and direct the user to internal website. It’s possible for a threat actor to find these IP addresses by enumerating the DNS with Dig and dnsenum.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">DNS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Dig: Nameserver Information</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Dig: Version Query</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> txt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version.bind</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Dig: Query all</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Dig: Query Zone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> axfr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Aggressively scanning for subdomains with dnsenum</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnsenum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dnsserver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;DNS-SERVER>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --enum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/opt/useful/seclists/Discovery/DNS/subdomains-top1million-110000.txt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span></span></code></pre></figure>
<p>It’s always recommended to enumerate DNS service as in some instances it’s possible to find out different web application’s and services the organization uses by viewing the TXT records.</p>
<h3 id="smtp">SMTP<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#smtp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Simple Mail Transfer Protocol (SMTP) is a protocol used for sending emails. It’s usually combined with IMAP and POP3 protocols as it allows the user to organize and view their emails. The SMTP service always runs on either TCP Port 25 or TCP Port 587 (Over SSL/TLS). If you’re interested in setting up SMTP service it’s recommended to use ESMTP as it’s more secure and reliable. Here are some commands which are useful to be familiar with to work with SMTP service.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SMTP</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Telnet: Connecting to SMTP service</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">telent</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMTP: Communicating</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HELO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EHLO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMTP: Finding users</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VRFY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMTP: Automatically enumerate users</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">smtp-user-enum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VRFY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAMELIST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;TARGET>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SMTP: Sending email</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAIL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> FROM:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mrb3n@inlanefreight.ht</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RCPT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TO:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mrb3n@inlanefreight.ht</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">DATA</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">From:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">cry0l1t3@inlanefreight.ht</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">To:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mrb3n@inlanefreight.ht</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Subject:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DB</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Date:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Tue,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 28</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Sept</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2021</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:32:51</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +0200</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Hey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> man,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> am</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> trying</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> access</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> our</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> XY-DB</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> but</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> creds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> don't work. </span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Did you make any changes there?</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span></span></code></pre></figure>
<p>VRFY command may seem completely useless but finding these usernames can be a goldmine as it allows us to launch our brute-force attack against valid usernames. You don’t necessary need to remember these commands but it’s useful to know these incase SMTP service is running on a target.</p>
<h3 id="imappop3">IMAP/POP3<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#imappop3" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Internet Message Access Protocol (IMAP) is a protocol that is assigned the TCP Port 143 and 993 and comes with capabilities for us to access emails, manage emails, and folder structure support. Post Office Protocol Version 3 (POP3) is a protocol that is assigned the TCP Port 110 and 995 and comes with same capabilities as IMAP besides folder structure support. While enumerating IMAP and POP3 services it’s always worth connecting to them TCP and TCP over HTTPS.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">IMAP/POP3</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Scannign IMAP and POP3</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sC</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 110,143,993,995</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nmap.result</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Netcat: Connecting to IMAP and POP3 using TCP</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ncat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RPORT>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OpenSSL: COnencting to IMAPs using TCP over HTTPS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s_client</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>:imaps'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># OpenSSL: Connecting to POP3s using TCP over HTTPS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openssl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s_client</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -connect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>:pop3s'</span></span></code></pre></figure>
<p>Once a connection has been established between our client and the IMAP or POP3 service it’s possible to communicate with the IMAP and POP3 service using the following commands.</p>
<p><strong>IMAP Commands</strong></p>





















































<div class="table-container"><table><thead><tr><th><strong>Command</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>1 LOGIN USERNAME PASSWORD</code></td><td>Logging into the IMAP service.</td></tr><tr><td><code>1 LIST '' *</code></td><td>Listing all mailboxes.</td></tr><tr><td><code>1 CREATE 'INBOX'</code></td><td>Creates a mailbox.</td></tr><tr><td><code>1 DELETE 'INBOX'</code></td><td>Deleting a mailbox.</td></tr><tr><td><code>1 RENAME 'INBOX' 'Important'</code></td><td>Renames a mailbox.</td></tr><tr><td><code>1 LSUB '' *</code></td><td>Returns a list of emails the mailbox is subscribed to.</td></tr><tr><td><code>1 SELECT 'INBOX'</code></td><td>Selects a mailbox so emails can be accessed.</td></tr><tr><td><code>1 UNSELECT 'INBOX'</code></td><td>Exits the selected mailbox.</td></tr><tr><td><code>1 FETCH 1 ALL</code></td><td>Retrieves data associated with a email.</td></tr><tr><td><code>1 FETCH 1 body[text]</code></td><td>Retrieving body associated with a email.</td></tr><tr><td><code>1 LOGOUT</code></td><td>Closes the IMAP server.</td></tr></tbody></table></div>
<p><strong>POP3 Commands:</strong></p>













































<div class="table-container"><table><thead><tr><th><strong>Command</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td><code>USER username</code></td><td>Identifies the user.</td></tr><tr><td><code>PASS password</code></td><td>Authentication of the user using its password.</td></tr><tr><td><code>STAT</code></td><td>Requests the number of saved emails from the server.</td></tr><tr><td><code>LIST</code></td><td>Requests from the server the number and size of all emails.</td></tr><tr><td><code>RETR id</code></td><td>Requests the server to deliver the requested email by ID.</td></tr><tr><td><code>DELE id</code></td><td>Requests the server to delete the requested email by ID.</td></tr><tr><td><code>CAPA</code></td><td>Requests the server to display the server capabilities.</td></tr><tr><td><code>RSET</code></td><td>Requests the server to reset the transmitted information.</td></tr><tr><td><code>QUIT</code></td><td>Closes the connection with the POP3 server.</td></tr></tbody></table></div>
<p>It’s not necessary to remember all these commands for IMAP and POP3 services but I highly recommend noting them down so it’s accessible in the future because it’ extremely useful to have them. If you’re interested in learning more about IMAP commands I recommend checking out <a href="https://donsutherland.org/crib/imap" class="external">IMAP Commands by DonustherLand<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
<h3 id="snmp">SNMP<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#snmp" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Simple Network Management Protocol is a protocol is used for monitoring and managing network devices such as routers, switches, and IOT devices. The SNMP protocol is assigned UDP Port 161 and it uses the UDP Port 162 t communicate with network devices incase of an event. SNMP also uses Management Information Base (MIB) to support different devices across different manufacturers.</p>
<p>The SNMPv3 is a secure protocol as it comes with authentication and encryption under transmission. However, SNMPv1 and SNMPv2 doesn’t come with these security capabilities and that allows threat actors to access community strings such as public and private. However, the SNMPv3 service can be misconfigured without any authentication which allows us to access strings inside SNMPv3. Here are some commands to enumerate the SNMP protocol.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">SNMP</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SNMPWalk: Obtaining information's about SNMPv1</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">snmpwalk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SNMPWalk: Obtaining information's about SNMPv2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">snmpwalk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 2c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SNMPWalk: Obtaining information's about SNMPv2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">snmpwalk</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noAuthNoPriv</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ALL</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>:&lt;RPORT>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Onesixtyone: Brute-force attacking SNMP service for strings</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onesixtyone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/wordlists/seclists/Discovery/SNMP/snmp.txt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span></code></pre></figure>
<p>In some instances the public and private strings doesn’t exists in SNMP protocol and in these instances it’s possible to use onesixtyone to launch a brute-force attack to find these strings.</p>
<h3 id="mysql">MySQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mysql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>MySQL is a database system that enables us to store information’s about our users, website settings, posts, and articles and much more… It’s common for dynamic web applications to fetch and update these data while doing authentication and updating title of the web applications. All these actions are completed using the SQL language.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="mysql" data-theme="github-light github-dark">MySQL</figcaption><pre tabindex="0" data-language="mysql" data-theme="github-light github-dark"><code data-language="mysql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span># Login to MySQL database</span></span>
<span data-line><span>mysql -u '&lt;USERNAME>' -p -h '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span># View all databases</span></span>
<span data-line><span>show databases;</span></span>
<span data-line> </span>
<span data-line><span># Select a database</span></span>
<span data-line><span>use '&lt;DATABASE-NAME>';</span></span>
<span data-line> </span>
<span data-line><span># View all tables</span></span>
<span data-line><span>show tables;</span></span>
<span data-line> </span>
<span data-line><span># View records inside a table</span></span>
<span data-line><span>select * from  '&lt;TABLE>';</span></span>
<span data-line> </span>
<span data-line><span># View records inside a table with filter</span></span>
<span data-line><span>select * from '&lt;TABLE>' WHERE name = 'John Doe';</span></span></code></pre></figure>
<p>MySQL database contains a-lot of valuable information’s about website, users, and customers and if these information’s are leaked it can significantly damage the reputation of the organization which can have a negative financial effect.</p>
<h3 id="mssql">MSSQL<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mssql" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Microsoft SQL (MMSQL) is a relational database system developed by Microsoft and it’s assigned the TCP Port 1433. MSSQL is popular because it’s compatible with the .NET programming language which is widely used for developing applications. In MSSQL all the actions are completed using the Transact-SQL language.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="mysql" data-theme="github-light github-dark"><code data-language="mysql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span># MSSQL (Local Account): Connecting to MSSQL using Linux</span></span>
<span data-line><span>mssqlclient '&lt;USERNAME>@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span># MSSQL (Domain Account): Connecting to MSSQL using Linux</span></span>
<span data-line><span>mssqlclient '&lt;USERNAME>@&lt;IP>' -windows-auth</span></span>
<span data-line> </span>
<span data-line><span># List all databases</span></span>
<span data-line><span>select name from sys.databases;</span></span>
<span data-line> </span>
<span data-line><span># List all tables</span></span>
<span data-line><span>select table_name from information_schema.tables;</span></span></code></pre></figure>
<p>Understanding and learning about MSSQL will be important for us as it’s a database system which is widely used by organization’s. I personally recommend setting up MSSQL on a virtual machine and start playing around with it.</p>
<h3 id="oracle-tns">Oracle TNS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#oracle-tns" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Oracle Transparent Network Substate (Oracle TNS) is a database system from Oracle which is assigned the TCP Port 1521 and it supports protocols such as IPX/PSX and TCP/IP because of that it’s preferred in industries such as healthcare, finance and retails. It also comes with security features such as encryption at rest and transit, comprehensive analysis tools, error reporting, logging, workload management, and fault tolerance.</p>
<p>To access a Oracle TNS it requires us to use a SID and valid credentials otherwise our connection will not be established with database. The SID is used by Oracle’s enterprise application to identify the database. It’s possible to brute-force attack the SID and credentials with the following commands.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Oracle TNS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Nmap: Brute-force attacking SID</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nmap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1521</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sV</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> oracle-sid-brute</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Odat: Brute-force attacking Credentials</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">odat.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SQLPlus: Logging in to Oracle TNS</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlplus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>@&lt;IP>/&lt;SID>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SQLPlus: Logging into a different databse</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sqlplus</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>@&lt;IP>/&lt;SID>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> as</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysdba</span></span></code></pre></figure>
<p>Accessing the Oracle TNS database requires us to install SQLPlus client from Oracle into our client machine. It’s possible to install the SQLPlus client using the following commands.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Oracle TNS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Install SQLPlus</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  oracle-instantclient-sqlplus</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Fix issue with SQLPLus</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;echo /usr/lib/oracle/12.2/client64/lib > /etc/ld.so.conf.d/oracle-instantclient.conf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldconfig</span></span></code></pre></figure>
<p>SQL language for Oracle TNS is similar to MSSQL database. However, it requires us to use different layout to access the different informations.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="sql" data-theme="github-light github-dark">Oracel TNS</figcaption><pre tabindex="0" data-language="sql" data-theme="github-light github-dark"><code data-language="sql" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Listing all tables</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> table_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all_tables;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- See all user privileges</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_role_privs;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Extact usernames and passwords</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">password</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> sys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$;</span></span></code></pre></figure>
<p>Oracle TNS is a popular application for enterprises as it’s compatible with Oracle’s enterprise applications. It’s worth digging deeper into the Oracle TNS if you’re interested learning more about it.</p>
<h3 id="ipmi">IPMI<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ipmi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>IPMI (Intelligent Platform Management Interface) is a hardware-based management system that is assigned the UDP Port 623 and it’s used for managing and monitoring systems even when they are powered off. It allows IT administrators to monitor temperature, voltage, fan status, and power supplies and it can be setup with SNMP to send alerts and logs. In some instances the IPMI can be accessed through default credentials because IT administrator forgot to change it.</p>

























<div class="table-container"><table><thead><tr><th><strong>Product</strong></th><th><strong>Username</strong></th><th><strong>Password</strong></th></tr></thead><tbody><tr><td>Dell iDRAC</td><td>root</td><td>calvin</td></tr><tr><td>HP iLO</td><td>Administrator</td><td>Randomized 8 character consisting with numbers and strings.</td></tr><tr><td>Supermicro IPMI</td><td>ADMIN</td><td>ADMIN</td></tr></tbody></table></div>
<p>If the HP iLO is using the default credentials it’s possible to use Hashcat to guess the password with the following command <code>{bash}hashcat -m 7300 ipmi.txt -a 3 ?1?1?1?1?1?1?1?1 -1 ?d?u</code>. In some instances it’s possible for us to dump the IPIMI hash using the following commands.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">IPMI</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Launch msfconsole</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">msfconsole</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Use IPMI bruteforce script</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auxiliary/scanner/ipmi/ipmi_dumphashes</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Setting Remote Port</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RHOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Executing brute-force attack</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Using hashcat to crack password hash</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hashcat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7300</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HASH>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/wordlists/rockyou.txt</span></span></code></pre></figure>
<p>IPMI protocol is extremely valuable for threat actors as once they have gotten access to IPMI it’s possible for them to access business critical systems as root and administrator user.</p>
<h3 id="remote-management-protocols">Remote Management Protocols<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#remote-management-protocols" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>In Linux the most common way of accessing a server remotely is SSH and R-Services. SSH is currently the standard protocol in modern systems but in older systems may still be using R-Services. The most common way for accessing Windows server remotely is through Remote Desktop Protocol (RDP), Windows Remote Management (WinRM), and Windows Management Instrumentations (WMI). Here’s a small overview of the different protocols:</p>

























<div class="table-container"><table><thead><tr><th>Name</th><th>Port</th><th>Description</th></tr></thead><tbody><tr><td>Remote Desktop Protocol</td><td>3389</td><td>A solution that allows administrators to manage system over SSL/TLS.</td></tr><tr><td>Windows Remote Management</td><td>5985, 5986</td><td>A solution that establishes connection between remote host using the Simple Object Access Protocol (SOAP) over SSL/TLS.</td></tr><tr><td>Windows management Instrumentation</td><td></td><td>Allows read and write access to all settings on a Windows systems such as PCs and servers and it’s usually accessed through PowerShell, VBScript, and Windows Instrumentation Console.</td></tr></tbody></table></div>
<p>Here is a overview of commands that allows us to access the Windows server remotely using Parrot OS, Kali Linux, and other Linux systems.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Remote Management Protocol</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SSH: Connecting to remote host</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SSH: Connecting to remote host using SSH key</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id_rsa</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>@&lt;IP>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Remote Desktop Protocol: Connecting to a remote host</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">xfreerdp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /u:'&lt;USERNAME>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /p:'&lt;PASSWORD>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /v:'&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows Remote Management: Connecting to remote host</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">evil-winrm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;PASSWORD>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows Management Instrumentation: Connecting to remote host</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wmiexec.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;USERNAME>:&lt;PASSWORD>@&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;HOSTNAME>'</span></span></code></pre></figure>
<p>It’s a-lot of information’s to grasp but understanding the different way we can access Windows servers is important since in some instances we might have obtained valid credentials where the server is only accessible using evil-winrm.</p>
<h2 id="web-reconnaissance">Web Reconnaissance<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#web-reconnaissance" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Web Reconnaissance consists of obtaining informations about the web applications to potentially find security misconfiguration and vulnerabilities which can be used to extract confidential informations or to remotely access the server. Web reconnaissance consists of three different stages and these are the following:</p>
<ul>
<li><strong>Identifying asset:</strong> Finding subdomains, directories, IP addresses, and technology company uses for web application.</li>
<li><strong>Discovering hidden informations:</strong> Finding backup files, git files, and internal documentations.</li>
<li><strong>Analzying the attack surface:</strong> Finding vulnerabilities and configurations which can be used to extract informations or obtain a shell into the server.</li>
<li><strong>Gather Intelligence:</strong> Identifying user principal name, email addresses, and patterns that can be exploited.</li>
</ul>
<p>It’s possible to do these stages actively or passively. If we choose actively it requires us to directly communicate with the server by launching Nmap, Fuzzing, Web Spidering, and so on. And if we choose passively it consists of using third party services such as Google, WHOIS, Web Archive, and Code Repositories.</p>
<h3 id="whois">WHOIS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#whois" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>WHOIS is a database that stores informations such as registrar, registrar contact, administrative contact, and nameserver about different domain names.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">WHOIS</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">whois</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span></code></pre></figure>
<p>With the informations obtained from the WHOIS it’s possible for us to launch a social engineering attack, phishing attack, and understand the services the company uses.</p>
<h3 id="subdomains">Subdomains<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#subdomains" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Subdomains is commonly used by organizations to access internal and external web applications. In some instances these subdomains can be running legacy or vulnerable web applications that can be exploited by threat actors. It’s possible for us to find all organizations subdomains using different tools such as dnsenum/ffuf/assetfinder.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Subdomains</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dnsenum</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --enum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>.com'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span></span></code></pre></figure>
<p>It’s important to use different wordlists to enumerate the subdomains as a single list may not be able to find all the subdomains. DNS Zone Transfer is commonly used for copying all DNS records from primary zone to secondary zone. If the DNS is misconfigured it allows threat actors to use DNS Zone Transfer to obtain all DNS records.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Subdomains</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. Getting nameservers</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ns</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. Exploiting DNS zone transfer</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> axfr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '@&lt;NAMESERVER>'</span></span></code></pre></figure>
<p>DNS Zone Transfer is common in organizations as IT-administrators may not be familiar with best security practices for it. However, for threat actors it allows them to obtain all the subdomains and IP addresses of our web application which is extremely valuable.</p>
<h3 id="vhost">VHOST<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#vhost" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Virtual Host (VHOST) is a configuration that comes with Apache, Nginx, and IIS that allows us to host multiple of websites using single host. There are three types of Virtual Hosting:</p>
<ul>
<li><strong>Name-Based Virtual Hosting:</strong> This method relies on HTTP Post Header to distinguish between different websites.</li>
<li><strong>IP-Based Virtual Hosting:</strong> This type assigns a unique IP-address to each website hosted on the server. This is preferred option as each websites are isolated from each other.</li>
<li><strong>Port-Based Virtual Hosting:</strong> The different websites are assigned ports on the same IP-address. This method requires the user to use a specific port to access the different websites.</li>
</ul>
<p>It’s possible for us to enumerate these virtual host configurations using tools such as gobuster, feroxbuster, and ffuf. Here’s a overview of the different commands.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">VHOST</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Gobuster: Finding VHOST</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gobuster</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'http://&lt;RHOST>:&lt;RPORT>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '/usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.txt'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --append-domain</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ffuf: Finding VHOST</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ffuf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'http://&lt;RHOST>:&lt;RPORT>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Host: FUZZ.&lt;RHOST>.com'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '/usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-110000.tx'</span></span></code></pre></figure>
<p>It’s worth running the different commands as gobuster is excellent for finding virtual hosts but ffuf is also great for finding subdomains which gobuster may have missed. It’s also worth running different wordlists against our targets as other penetration testers more likely already ran the common wordlists against target.</p>
<h3 id="fingerprinting">Fingerprinting<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#fingerprinting" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Fingerprinting is about finding out the different technologies a web application uses. This is about finding out the web server, operating system, and software components that the web application as that allows us to search for vulnerabilities for these technologies. Here are some technologies that can be useful to obtain these informations:</p>

































<div class="table-container"><table><thead><tr><th><strong>Tool</strong></th><th><strong>Description</strong></th></tr></thead><tbody><tr><td>Wappalyzer</td><td>Identifies a wide range of technologies including CMS, Frameworks, and analytics and much more…</td></tr><tr><td>BuiltWithin</td><td>Provides detailed report about the technology stack.</td></tr><tr><td>WhatWeb</td><td>Uses vast database of signatures to identify web technologies.</td></tr><tr><td>Nmap</td><td>Scripts can be used for obtaining fingerprinting informations.</td></tr><tr><td>Netcraft</td><td>Provides detailed reports on a website’s technology, hosting provider, and security posture.</td></tr><tr><td>wafw00f</td><td>Helps determining the WAF is present and the type of configuration.</td></tr></tbody></table></div>
<p>We can use the following commands on our machines to also obtain these informations.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Fingerprinting</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Banner Grabbing</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -I</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Detecting WAF</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wafw00f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Detecting software components of web application</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nikto</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '&lt;RHOST>'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Tuning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> b</span></span></code></pre></figure>
<h3 id="crawling">Crawling<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#crawling" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Crawling (Spidering) is a automated bot that goes through different sites and collect links and extracts the informations from these links. The recommended algorithms for crawlers are Breadth-First and Depth-First. It’s recommended to use Breadth-First algorithm if you need a broad overview of the web application but if you need specific content and dig deep into the infrastructure the Depth-First algorithm is recommended. The Burp Suite Spider and ReconSpider is excellent for crawling web applications.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Crawling</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ReconSpider</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'http://&lt;RHOST>'</span></span></code></pre></figure>
<p>Crawlers can be useful for obtaining API keys, configuration files, backup files, error logs, backup logs. In some instances it might be able to discover hidden urls and find the version of component and the software the website is powered with. It’s important to note that majority of crawlers can be blocked with <code>robots.txt</code> file.</p>
<h3 id="search-engines">Search Engines<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#search-engines" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Search Engines is a great way of obtaining email addresses, credentials, confidential documents, and hidden files and folders. We can use the <a href="https://www.exploit-db.com/google-hacking-database" class="external">Google Hacking Database<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> to create specific queries for our needs. Here are some queries that is possible for us to create.</p>
<figure data-rehype-pretty-code-figure><figcaption data-rehype-pretty-code-title data-language="shell" data-theme="github-light github-dark">Search Engines</figcaption><pre tabindex="0" data-language="shell" data-theme="github-light github-dark"><code data-language="shell" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Finding .pdf files</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">site:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'http://&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> intext:'confidential document'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> filetype:'pdf'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Finding login pages</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">site:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'http://&lt;RHOST>'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inurl:'login'</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Finding configuration files</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">site:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">'http://&lt;RHOST>'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (intext:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'.env'</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> intext:'.git'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></figure>
<p>This is a great way of obtaining information about a target in a passively way because there is no way of detecting us. It’s also a possibility that Google has indexed confidential data which can be valuable for us.</p>
<h3 id="waybackmachine">WayBackMachine<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#waybackmachine" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>WayBackMachine is a snapshot database for web application. It allows us to access old version of the web application and in some instances we might be able to obtain confidential documents, credentials, and API keys by inspecting the old version of the application.</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul class="toc-content overflow" id="list-1"><li class="depth-0"><a href="#osint" data-for="osint">OSINT</a></li><li class="depth-1"><a href="#employees" data-for="employees">Employees</a></li><li class="depth-1"><a href="#domain-name" data-for="domain-name">Domain Name</a></li><li class="depth-1"><a href="#cloud-storage" data-for="cloud-storage">Cloud Storage</a></li><li class="depth-0"><a href="#nmap" data-for="nmap">Nmap</a></li><li class="depth-0"><a href="#protocols" data-for="protocols">Protocols</a></li><li class="depth-1"><a href="#ssh" data-for="ssh">SSH</a></li><li class="depth-1"><a href="#ftp" data-for="ftp">FTP</a></li><li class="depth-1"><a href="#smb" data-for="smb">SMB</a></li><li class="depth-1"><a href="#nfs" data-for="nfs">NFS</a></li><li class="depth-1"><a href="#dns" data-for="dns">DNS</a></li><li class="depth-1"><a href="#smtp" data-for="smtp">SMTP</a></li><li class="depth-1"><a href="#imappop3" data-for="imappop3">IMAP/POP3</a></li><li class="depth-1"><a href="#snmp" data-for="snmp">SNMP</a></li><li class="depth-1"><a href="#mysql" data-for="mysql">MySQL</a></li><li class="depth-1"><a href="#mssql" data-for="mssql">MSSQL</a></li><li class="depth-1"><a href="#oracle-tns" data-for="oracle-tns">Oracle TNS</a></li><li class="depth-1"><a href="#ipmi" data-for="ipmi">IPMI</a></li><li class="depth-1"><a href="#remote-management-protocols" data-for="remote-management-protocols">Remote Management Protocols</a></li><li class="depth-0"><a href="#web-reconnaissance" data-for="web-reconnaissance">Web Reconnaissance</a></li><li class="depth-1"><a href="#whois" data-for="whois">WHOIS</a></li><li class="depth-1"><a href="#subdomains" data-for="subdomains">Subdomains</a></li><li class="depth-1"><a href="#vhost" data-for="vhost">VHOST</a></li><li class="depth-1"><a href="#fingerprinting" data-for="fingerprinting">Fingerprinting</a></li><li class="depth-1"><a href="#crawling" data-for="crawling">Crawling</a></li><li class="depth-1"><a href="#search-engines" data-for="search-engines">Search Engines</a></li><li class="depth-1"><a href="#waybackmachine" data-for="waybackmachine">WayBackMachine</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.0</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
        const socket = new WebSocket('ws://localhost:3001')
        // reload(true) ensures resources like images and scripts are fetched again in firefox
        socket.addEventListener('message', () => document.location.reload(true))
      </script><script src="../postscript.js" type="module"></script></html>